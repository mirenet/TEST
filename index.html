<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Floating YouTube Player Playlist Offscreen</title>

<style>
body{
    margin:0;
    height:200vh;
    background:#111;
    font-family:Arial;
    color:white;
}

/* Floating box */
#floating-player{
    position:fixed;
    width:160px;
    height:90px;
    background:#000;
    border-radius:14px;
    box-shadow:0 10px 25px rgba(0,0,0,0.5);
    overflow:hidden;
    z-index:9999;
    touch-action:none;
    transform: translateY(200vh);
    transition: transform 0.3s ease;
}

/* Drag area */
#drag-handle{
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:24px;
    background:rgba(0,0,0,0.4);
    cursor:grab;
    z-index:10;
}

/* Resize handle */
#resize-handle{
    position:absolute;
    width:18px;
    height:18px;
    right:0;
    bottom:0;
    background:rgba(255,255,255,0.4);
    border-top-left-radius:6px;
    cursor:nwse-resize;
    z-index:10;
}

#player{
    width:100%;
    height:100%;
    border:none;
}

/* Controls bar */
#controls-bar{
    position:fixed;
    bottom:20px;
    left:50%;
    transform:translateX(-50%);
    display:flex;
    align-items:center;
    gap:20px;
    z-index:10000;
}

/* Buttons */
.ctrl-btn{
    width:70px;
    height:70px;
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:28px;
    font-weight:bold;
    color:black;
    background:#444;
    user-select:none;
    touch-action:none;
}

#play-btn{
    background:#6b8e23;
}
#stop-btn{
    background:#fff;
    color:black;
}
#next-btn{
    background:#808080;
}
</style>
</head>

<body>

<div id="floating-player">
    <div id="drag-handle"></div>
    <iframe id="player" allow="autoplay; fullscreen" allowfullscreen></iframe>
    <div id="resize-handle"></div>
</div>

<div id="controls-bar">
    <div class="ctrl-btn" id="stop-btn">■</div>
    <div class="ctrl-btn" id="play-btn">▶</div>
    <div class="ctrl-btn" id="next-btn">⏭</div>
</div>

<script>
const playlist = [
  "dQw4w9WgXcQ","3tmd-ClpJxA","L_jWHffIx5E","kJQP7kiw5Fk","fRh_vgS2dFE",
  "RgKAFK5djSk","CevxZvSJLk8","2Vv-BfVoq4g","uelHwf8o7_U","hT_nvWreIhg",
  "09R8_2nJtjg","YqeW9_5kURI","fLexgOxsZu0","K0ibBPhiaG0","d9MyW72ELq0"
];
let currentIndex = 0;

const iframe = document.getElementById("player");

function loadVideo(index){
    const id = playlist[index];
    iframe.src = `https://www.youtube.com/embed/${id}?autoplay=0&controls=1&playsinline=1&rel=0`;
}

/* INIT */
loadVideo(currentIndex);

/* Floating player drag/resize */
const box = document.getElementById("floating-player");
const dragHandle = document.getElementById("drag-handle");
const resizeHandle = document.getElementById("resize-handle");

let isDragging=false, isResizing=false;
let startX, startY, startWidth, startHeight;

let savedPos = JSON.parse(localStorage.getItem("playerPos")) || {left:null, top:null};

/* DRAG */
dragHandle.addEventListener("pointerdown", e=>{
    isDragging=true;
    startX = e.clientX - box.offsetLeft;
    startY = e.clientY - box.offsetTop;
    dragHandle.style.cursor="grabbing";
});
document.addEventListener("pointermove", e=>{
    if(isDragging){
        box.style.left = (e.clientX-startX)+"px";
        box.style.top = (e.clientY-startY)+"px";
        box.style.right="auto";
        box.style.bottom="auto";
    }
    if(isResizing){
        let w = startWidth + (e.clientX-startX);
        let h = startHeight + (e.clientY-startY);
        if(w>120 && h>70){
            box.style.width=w+"px";
            box.style.height=h+"px";
        }
    }
});
document.addEventListener("pointerup", e=>{
    if(isDragging){isDragging=false; dragHandle.style.cursor="grab"; savePosition();}
    if(isResizing){isResizing=false; savePosition();}
});

/* RESIZE */
resizeHandle.addEventListener("pointerdown", e=>{
    isResizing=true;
    startX=e.clientX;
    startY=e.clientY;
    startWidth=box.offsetWidth;
    startHeight=box.offsetHeight;
});

/* Controls */
const playBtn = document.getElementById("play-btn");
const stopBtn = document.getElementById("stop-btn");
const nextBtn = document.getElementById("next-btn");

playBtn.addEventListener("click", ()=>{
    // Reload iframe src sa autoplay=1 da bi se video pustio sa zvukom
    const id = playlist[currentIndex];
    iframe.src = `https://www.youtube.com/embed/${id}?autoplay=1&controls=1&playsinline=1&rel=0`;
});

stopBtn.addEventListener("click", ()=>{
    // Reload iframe sa autoplay=0 da zaustavi video
    const id = playlist[currentIndex];
    iframe.src = `https://www.youtube.com/embed/${id}?autoplay=0&controls=1&playsinline=1&rel=0`;
});

nextBtn.addEventListener("click", ()=>{
    currentIndex = (currentIndex + 1) % playlist.length;
    iframe.src = `https://www.youtube.com/embed/${playlist[currentIndex]}?autoplay=1&controls=1&playsinline=1&rel=0`;
});

/* SHOW/HIDE */
function showPlayer(){
    if(savedPos.left!==null && savedPos.top!==null){
        box.style.left = savedPos.left+"px";
        box.style.top = savedPos.top+"px";
    } else {
        box.style.left = (window.innerWidth/2 - box.offsetWidth/2)+"px";
        box.style.top = (window.innerHeight/2 - box.offsetHeight/2)+"px";
    }
    box.style.transform="translateY(0)";
}
function hidePlayer(){
    box.style.transform="translateY(200vh)";
}

/* SAVE POSITION */
function savePosition(){
    savedPos.left = box.offsetLeft;
    savedPos.top = box.offsetTop;
    localStorage.setItem("playerPos", JSON.stringify(savedPos));
}
</script>

</body>
</html>
