<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bubble Player UX</title>

<style>
body{
    margin:0;
    background:#111;
    font-family:Arial;
    overflow:hidden;
}

/* Bottom controls bar */
#controls-bar{
    position:fixed;
    bottom:20px;
    width:100%;
    display:flex;
    justify-content:center;
    align-items:center;
    gap:25px;
    z-index:10000;
}

/* Play button (bubble origin) */
#play-btn{
    width:70px;
    height:70px;
    border-radius:50%;
    background:#6b8e23;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:28px;
    color:black;
    font-weight:bold;
    touch-action:none;
}

/* Stop / Next */
.ctrl-btn{
    font-size:26px;
    color:white;
}

/* Floating player */
#floating-player{
    position:fixed;
    bottom:100px;
    left:50%;
    transform:translateX(-50%) scale(0);
    width:260px;
    height:150px;
    background:black;
    border-radius:18px;
    overflow:hidden;
    box-shadow:0 15px 40px rgba(0,0,0,0.6);
    transition:transform 0.3s ease, border-radius 0.3s ease;
    z-index:9999;
}

#floating-player.active{
    transform:translateX(-50%) scale(1);
}

#drag-handle{
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:25px;
    background:rgba(0,0,0,0.4);
    z-index:10;
}

#resize-handle{
    position:absolute;
    width:18px;
    height:18px;
    right:0;
    bottom:0;
    background:rgba(255,255,255,0.5);
    border-top-left-radius:6px;
    z-index:10;
}

#player{
    width:100%;
    height:100%;
}
</style>
</head>

<body>

<div id="floating-player">
    <div id="drag-handle"></div>
    <div id="player"></div>
    <div id="resize-handle"></div>
</div>

<div id="controls-bar">
    <div class="ctrl-btn" id="stop-btn">■</div>
    <div id="play-btn">▶</div>
    <div class="ctrl-btn" id="next-btn">⏭</div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>

<script>
let player;
let expanded = false;
let startY;
let swipeStartTime;

function onYouTubeIframeAPIReady(){
    player = new YT.Player('player', {
        videoId: "dQw4w9WgXcQ",
        playerVars:{
            autoplay:0,
            controls:1,
            playsinline:1
        }
    });
}

/* Swipe to expand */
const playBtn = document.getElementById("play-btn");
const floating = document.getElementById("floating-player");

playBtn.addEventListener("pointerdown", e=>{
    startY = e.clientY;
    swipeStartTime = Date.now();
});

playBtn.addEventListener("pointerup", e=>{
    let diff = startY - e.clientY;

    if(diff > 50){ // swipe up
        expandPlayer();
    } else {
        togglePlay();
    }
});

/* Swipe down to minimize */
const dragHandle = document.getElementById("drag-handle");

dragHandle.addEventListener("pointerdown", e=>{
    startY = e.clientY;
    swipeStartTime = Date.now();
});

dragHandle.addEventListener("pointerup", e=>{
    let diff = e.clientY - startY;
    let time = Date.now() - swipeStartTime;

    if(diff > 80 && time < 300){
        minimizePlayer();
    }
});

function expandPlayer(){
    floating.classList.add("active");
    expanded = true;
    player.playVideo();
}

function minimizePlayer(){
    floating.classList.remove("active");
    expanded = false;
}

function togglePlay(){
    let state = player.getPlayerState();
    if(state == 1){
        player.pauseVideo();
    } else {
        player.playVideo();
    }
}

document.getElementById("stop-btn").onclick = ()=>{
    player.stopVideo();
};

document.getElementById("next-btn").onclick = ()=>{
    player.loadVideoById("3tmd-ClpJxA");
};
</script>

</body>
</html>
